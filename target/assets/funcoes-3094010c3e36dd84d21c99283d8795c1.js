$(document).ready(function(){function r(e){$("#container").highcharts({chart:{type:"line",backgroundColor:"#fff"},title:{text:"Horas do Mes "+e.mes+" de "+e.ano+" ("+document.getElementById("totalgeral").value+")",margin:50},subtitle:{text:""},xAxis:{categories:e.dias,title:{text:"Dia do Mes"}},yAxis:{title:{text:"Quantidade Horas (dia)"},gridLineWidth:0,tickInterval:.1},plotOptions:{line:{dataLabels:{enabled:true},enableMouseTracking:false}},series:[{name:e.usuario,data:e.totaldia,dataLabels:{enabled:true,rotation:-90,color:"#000",align:"top",x:4,y:-10,style:{fontSize:"11px",fontFamily:"Verdana, sans-serif",textShadow:"0 0 3px #fff"}}}]})}var t=$("#formupdate").serializeArray();var n="/controledehoras/horas/atualizatotal";$.ajax({url:n,type:"POST",data:t,dataType:"json",success:function(e,t,n){var i=0;var s=0;while(s<e.dias.length){var o="totaldia"+e.dias[s];var u=e.totaldia[s].toFixed(3).replace(".",",");document.getElementById(o).value=u;i=i+e.totaldia[s];s++}document.getElementById("totalgeral").value=i.toFixed(3).replace(".",",");r(e)},error:function(e,t,n){var r=0;var i='<ul class="errors" role="alert">';var s="";var o="</div>";while(r<e.responseJSON.length){s=s+"<li>"+e.responseJSON[r]+"</li>";r++}var u=i+s+o;$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxerror").html(u)}});$(".totaliza").click(function(){var t=$(this).closest("tr").find("#totalizahidden");if($(this).is(":checked")){t.val("1")}else{t.val("0")}var n=$("#formupdate").serializeArray();var i=$("#formupdate").attr("action");$.ajax({url:i,type:"POST",data:n,dataType:"json",success:function(e,t,n){var i=0;var s=0;while(s<e.dias.length){var o="totaldia"+e.dias[s];var u=e.totaldia[s].toFixed(3).replace(".",",");document.getElementById(o).value=u;i=i+e.totaldia[s];s++}document.getElementById("totalgeral").value=i.toFixed(3).replace(".",",");var a='<div class="message" role="status">Horario Salvo</div>';$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxmessage").html(a);r(e)},error:function(e,t,n){var r=0;var i='<ul class="errors" role="alert">';var s="";var o="</div>";while(r<e.responseJSON.length){s=s+"<li>"+e.responseJSON[r]+"</li>";r++}var u=i+s+o;$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxerror").html(u)}});e.preventDefault()});$("#formupdatesubmit").click(function(e){var t=$("#formupdate").serializeArray();var n=$("#formupdate").attr("action");$.ajax({url:n,type:"POST",data:t,dataType:"json",success:function(e,t,n){var i=0;var s=0;while(s<e.dias.length){var o="totaldia"+e.dias[s];var u=e.totaldia[s].toFixed(3).replace(".",",");document.getElementById(o).value=u;i=i+e.totaldia[s];s++}document.getElementById("totalgeral").value=i.toFixed(3).replace(".",",");var a='<div class="message" role="status">Horario Salvo</div>';$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxmessage").html(a);r(e)},error:function(e,t,n){var r=0;var i='<ul class="errors" role="alert">';var s="";var o="</div>";while(r<e.responseJSON.length){s=s+"<li>"+e.responseJSON[r]+"</li>";r++}var u=i+s+o;$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxerror").html(u)}});e.preventDefault()});$(".timeentry").blur(function(e){var t=$("#formupdate").serializeArray();var n="/controledehoras/horas/atualizatotal";$.ajax({url:n,type:"POST",data:t,dataType:"json",success:function(e,t,n){var i=0;var s=0;while(s<e.dias.length){var o="totaldia"+e.dias[s];var u=e.totaldia[s].toFixed(3).replace(".",",");document.getElementById(o).value=u;i=i+e.totaldia[s];s++}document.getElementById("totalgeral").value=i.toFixed(3).replace(".",",");r(e)},error:function(e,t,n){var r=0;var i='<ul class="errors" role="alert">';var s="";var o="</div>";while(r<e.responseJSON.length){s=s+"<li>"+e.responseJSON[r]+"</li>";r++}var u=i+s+o;$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxerror").html(u)}});e.preventDefault()})})