function mostraGrafico(e){$("#container").highcharts({chart:{type:"line",backgroundColor:"#fbf5ef"},title:{text:"Horas do Mes "+e["mes"]+" de "+e["ano"]+" ("+document.getElementById("totalgeral").value+")",margin:50},subtitle:{text:""},xAxis:{categories:e["dias"],title:{text:"Dia do Mes"}},yAxis:{title:{text:"Quantidade Horas (dia)"},gridLineWidth:0,tickInterval:.1},plotOptions:{line:{dataLabels:{enabled:true},enableMouseTracking:false}},series:[{name:e["usuario"],data:e["totaldia"],dataLabels:{enabled:true,rotation:-90,color:"#000",align:"top",x:4,y:-10,style:{fontSize:"11px",fontFamily:"Verdana, sans-serif",textShadow:"0 0 3px #fff"}}}]})}function atualizaCampo(){var e=$("#formupdate").attr("action");trataDadosTela(e)}function trataDadosTela(e,t){var n=$("#formupdate").serializeArray();var r=e;$.ajax({url:r,type:"POST",data:n,dataType:"json",success:function(t,n,r){var i=0;var s=0;var o=[];var u=[];var a=[];while(s<t.horas.length){var f="totaldia"+t.horas[s].id;var l=t.horas[s].totaldia.toFixed(3).replace(".",",");var c=t.horas[s].totaliza;if(c=="1"){document.getElementById(f).value=l;i=i+t.horas[s].totaldia;u.push(t.horas[s].dia);a.push(t.horas[s].totaldia)}else{document.getElementById(f).value="0,000"}s++}o["mes"]=t.horas[0].mes;o["ano"]=t.horas[0].ano;o["usuario"]=t.usuario;o["dias"]=u;o["totaldia"]=a;document.getElementById("totalgeral").value=i.toFixed(3).replace(".",",");if(e!=="/controledehoras/horas/atualizatotal"){var h='<div class="message" role="status">Horario Salvo</div>'}$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxmessage").html(h);mostraGrafico(o)},error:function(e,t,n){var r=0;var i='<ul class="errors" role="alert">';var s="";var o="</div>";while(r<e.responseJSON.length){s=s+"<li>"+e.responseJSON[r]+"</li>";r++}var u=i+s+o;$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxerror").html(u)}});t.preventDefault()}function carregaTela(){var e=$("#formupdate").serializeArray();var t="/controledehoras/horas/atualizatotal";$.ajax({url:t,type:"POST",data:e,dataType:"json",success:function(e,t,n){var r=0;var i=0;var s=[];var o=[];var u=[];while(i<e.horas.length){var a="totaldia"+e.horas[i].id;var f=e.horas[i].totaldia.toFixed(3).replace(".",",");var l=e.horas[i].totaliza;if(l=="1"){document.getElementById(a).value=f;r=r+e.horas[i].totaldia;o.push(e.horas[i].dia);u.push(e.horas[i].totaldia)}else{document.getElementById(a).value=0}i++}s["mes"]=e.horas[0].mes;s["ano"]=e.horas[0].ano;s["usuario"]=e.usuario;s["dias"]=o;s["totaldia"]=u;document.getElementById("totalgeral").value=r.toFixed(3).replace(".",",");mostraGrafico(s)},error:function(e,t,n){var r=0;var i='<ul class="errors" role="alert">';var s="";var o="</div>";while(r<e.responseJSON.length){s=s+"<li>"+e.responseJSON[r]+"</li>";r++}var u=i+s+o;$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxerror").html(u)}})}