function mostraGrafico(d){$("#container").highcharts({chart:{type:"line",backgroundColor:"#fbf5ef"},title:{text:"Horas do Mes "+d.mes+" de "+d.ano+" ("+document.getElementById("totalgeral").value+")",margin:50},subtitle:{text:""},xAxis:{categories:d.dias,title:{text:"Dia do Mes"}},yAxis:{title:{text:"Quantidade Horas (dia)"},gridLineWidth:0,tickInterval:.1},plotOptions:{line:{dataLabels:{enabled:!0},enableMouseTracking:!1}},series:[{name:d.usuario,data:d.totaldia,dataLabels:{enabled:!0,rotation:-90,
color:"#000",align:"top",x:4,y:-10,style:{fontSize:"11px",fontFamily:"Verdana, sans-serif",textShadow:"0 0 3px #fff"}}}]})}function atualizaCampo(){var d=$("#formupdate").attr("action");trataDadosTela(d)}
function trataDadosTela(d,b){var c=$("#formupdate").serializeArray();$.ajax({url:d,type:"POST",data:c,dataType:"json",success:function(a,b,e){e=b=0;for(var c=[],f=[],g=[];e<a.horas.length;){var k="totaldia"+a.horas[e].id,l=a.horas[e].totaldia.toFixed(3).replace(".",",");"1"==a.horas[e].totaliza?(document.getElementById(k).value=l,b+=a.horas[e].totaldia,f.push(a.horas[e].dia),g.push(a.horas[e].totaldia)):document.getElementById(k).value="0,000";e++}c.mes=a.horas[0].mes;c.ano=a.horas[0].ano;c.usuario=
a.usuario;c.dias=f;c.totaldia=g;document.getElementById("totalgeral").value=b.toFixed(3).replace(".",",");if("/controledehoras/horas/atualizatotal"!==d)var m='<div class="message" role="status">Horario Salvo</div>';$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxmessage").html(m);mostraGrafico(c)},error:function(a,b,c){b=0;for(c="";b<a.responseJSON.length;)c=c+"<li>"+a.responseJSON[b]+"</li>",b++;a='<ul class="errors" role="alert">'+c+"</div>";$(".ajaxmessage").html("");$(".ajaxerror").html("");
$(".ajaxerror").html(a)}});b.preventDefault()}
function carregaTela(){var d=$("#formupdate").serializeArray();$.ajax({url:"/controledehoras/horas/atualizatotal",type:"POST",data:d,dataType:"json",success:function(b,c,a){a=c=0;for(var d=[],e=[],h=[];a<b.horas.length;){var f="totaldia"+b.horas[a].id,g=b.horas[a].totaldia.toFixed(3).replace(".",",");"1"==b.horas[a].totaliza?(document.getElementById(f).value=g,c+=b.horas[a].totaldia,e.push(b.horas[a].dia),h.push(b.horas[a].totaldia)):document.getElementById(f).value=0;a++}d.mes=b.horas[0].mes;d.ano=
b.horas[0].ano;d.usuario=b.usuario;d.dias=e;d.totaldia=h;document.getElementById("totalgeral").value=c.toFixed(3).replace(".",",");mostraGrafico(d)},error:function(b,c,a){c=0;for(a="";c<b.responseJSON.length;)a=a+"<li>"+b.responseJSON[c]+"</li>",c++;b='<ul class="errors" role="alert">'+a+"</div>";$(".ajaxmessage").html("");$(".ajaxerror").html("");$(".ajaxerror").html(b)}})};